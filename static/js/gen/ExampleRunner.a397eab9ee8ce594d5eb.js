!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("tlex",[],t):"object"==typeof exports?exports.tlex=t():(e.tlex=e.tlex||{},e.tlex.ExampleRunner=t())}(this,()=>(()=>{"use strict";var e,t={2841(e,t,n){n.r(t),n.d(t,{ExampleRunner:()=>d});var i,s=n(7346),a=n(4516),r=n.n(a),o=(n(2145),n(621),n(8542),n(8005),n(6383));function l(e,t){const n=new s.Tape(e),a=function(){const e=new s.Tokenizer;return e.add(/->/,{tag:i.ARROW}),e.add(/\[/,{tag:i.OPEN_SQ}),e.add(/\]/,{tag:i.CLOSE_SQ}),e.add(/\(/,{tag:i.OPEN_PAREN}),e.add(/\)/,{tag:i.CLOSE_PAREN}),e.add(/\{/,{tag:i.OPEN_BRACE}),e.add(/\}/,{tag:i.CLOSE_BRACE}),e.add(/\*/,{tag:i.STAR}),e.add(/\+/,{tag:i.PLUS}),e.add(/\?/,{tag:i.QMARK}),e.add(/;/,{tag:i.SEMI_COLON}),e.add(/:/,{tag:i.COLON}),e.add(/\|/,{tag:i.PIPE}),e.add(/\s+/m,{tag:i.SPACES},()=>null),e.add(/\/\*.*?\*\//s,{tag:i.COMMENT},()=>null),e.add(/\/\/.*$/m,{tag:i.COMMENT},()=>null),e.add(s.Samples.DOUBLE_QUOTE_STRING,{tag:i.STRING},(e,t,n)=>(n.value=t.substring(n.start+1,n.end-1),n)),e.add(s.Samples.SINGLE_QUOTE_STRING,{tag:i.STRING},(e,t,n)=>(n.value=t.substring(n.start+1,n.end-1),n)),e.add(s.Samples.JS_REGEX,{tag:i.REGEX},(e,t,n)=>{const i=t.substring(n.positions[1][0],n.positions[1][1]),s=t.substring(n.positions[3][0],n.positions[3][1]);return n.value=[i,s],n}),e.add(/\d+/,{tag:i.NUMBER},(e,t,n)=>(n.value=parseInt(t.substring(n.start,n.end)),n)),e.add(/%([\w][\w\d_]*)/,{tag:i.PCT_IDENT},(e,t,n)=>(n.value=t.substring(n.start+1,n.end),n)),e.add(/\$\d+/,{tag:i.DOLLAR_NUM},(e,t,n)=>(n.value=parseInt(t.substring(n.start+1,n.end)),n)),e.add(/\$([\w][\w\d_]*)/,{tag:i.DOLLAR_IDENT},(e,t,n)=>(n.value=t.substring(n.start+1,n.end),n)),e.add(/[\w][\w\d_]*/,{tag:i.IDENT}),e}(),r=new s.TokenBuffer(e=>a.next(e,null),null);let o="js";const l=new s.Tokenizer;function d(e){if("resyntax"===e){const e=r.expectToken(n,i.IDENT);if("js"!==e.value&&"flex"!==e.value)throw new SyntaxError("Invalid regex syntax: "+e.value);o=e.value}else if(e.startsWith("skip")){const t=u("",30,e.endsWith("flex")?"flex":""),i=c(n);i?l.addRule(t,(e,t,n)=>(i(e,t,n,null),null)):l.addRule(t,()=>null)}else{if(!e.startsWith("token")&&!e.startsWith("define"))throw new Error("Invalid directive: "+e);{const t=e.startsWith("define"),s=r.expectToken(n,i.IDENT,i.STRING);let a=s.value;s.tag!==i.STRING&&s.tag!==i.NUMBER||(a=`"${s.value}"`);const o=u(a,0,e.endsWith("flex")?"flex":"");if(!t){const e=c(n);return l.addRule(o,e),a}l.addVar(a,o.expr)}}return null}function u(e,t=0,a=""){if(""===a&&(a=o),"js"===a){const a=r.expectToken(n,i.STRING,i.NUMBER,i.REGEX);let o;if(e&&0!==e.length||(e="/"+a.value[0]+"/"+a.value[1]),a.tag===i.STRING||a.tag===i.NUMBER){const n="number"==typeof(l=a.value)?""+l:l.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");o=s.Builder.build(n,{tag:e,priority:t+20})}else{if(a.tag!==i.REGEX)throw new s.UnexpectedTokenError(a);{let n=a.value[0];a.value[1].length>0&&(n=new RegExp(a.value[0],a.value[1])),o=s.Builder.build(n,{tag:e,priority:t+10})}}return o}{let i="";for(;n.hasMore&&"\n"!==n.currCh;)i+=n.currCh,n.advance(1);return i=i.trim(),e&&0!==e.length||(e="/"+i+"/"),new s.Rule(s.Builder.exprFromFlexRE(i),{tag:e,priority:t})}var l}function c(e){if(!r.consumeIf(e,i.OPEN_BRACE))return null;const n=r.expectToken(e,i.IDENT);return r.expectToken(e,i.CLOSE_BRACE),(e,i,s,a)=>{const r=t[n.value];if(!r)throw new Error("Handler method not found: "+n.value);return r(s,i,a)}}return function(){let e=r.peek(n);for(;null!=e;){if(e.tag!==i.PCT_IDENT)throw new SyntaxError(`Declaration must start with %token/%token_flex, %skip or %define, Found: ${e.tag}`);r.next(n),d(e.value),e=r.peek(n)}}(),l}!function(e){e.ARROW="ARROW",e.OPEN_PAREN="OPEN_PAREN",e.CLOSE_PAREN="CLOSE_PAREN",e.OPEN_BRACE="OPEN_BRACE",e.CLOSE_BRACE="CLOSE_BRACE",e.OPEN_SQ="OPEN_SQ",e.CLOSE_SQ="CLOSE_SQ",e.STAR="STAR",e.PLUS="PLUS",e.QMARK="QMARK",e.PIPE="PIPE",e.COLON="COLON",e.SEMI_COLON="SEMI_COLON",e.SPACES="SPACES",e.COMMENT="COMMENT",e.STRING="STRING",e.REGEX="REGEX",e.NUMBER="NUMBER",e.IDENT="IDENT",e.PCT_IDENT="PCT_IDENT",e.DOLLAR_NUM="DOLLAR_NUM",e.DOLLAR_IDENT="DOLLAR_IDENT"}(i||(i={}));class d{constructor(e,t){this.rulesEditor=null,this.inputEditor=null,this.outputContainer=null,this.tokenizer=null,this.incrementalTokenizer=null,this.lastInput="",this.fullOutputContainer=null,this.incrementalOutputContainer=null,this.fullStatsEl=null,this.incrementalStatsEl=null;const n=document.getElementById(e);n?(this.container=n,this.config={showRules:!0,mode:"basic",...t},this.init()):console.error(`Container #${e} not found`)}isDarkMode(){return document.documentElement.classList.contains("dark")}getEditorTheme(){return this.isDarkMode()?"ace/theme/monokai":"ace/theme/github"}init(){this.render(),this.setupEditors(),this.setupEventListeners(),new MutationObserver(()=>{this.updateEditorThemes()}).observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),setTimeout(()=>this.run(),100)}render(){const e=!1!==this.config.showRules;"incremental"===this.config.mode?this.renderIncrementalMode(e):this.renderBasicMode(e)}renderBasicMode(e){this.container.innerHTML=`\n      <div class="example-runner">\n        <div class="example-main">\n          ${e?`\n          <div class="example-column example-rules-column">\n            <div class="example-panel-header">\n              <span class="example-panel-title">Lexer Rules</span>\n              <button class="example-copy-btn" data-target="rules" title="Copy rules">\n                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>\n                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>\n                </svg>\n              </button>\n            </div>\n            <div class="example-editor-container" id="${this.container.id}-rules-editor"></div>\n          </div>\n          `:""}\n          <div class="example-column example-io-column">\n            <div class="example-io-row example-input-row">\n              <div class="example-panel-header">\n                <span class="example-panel-title">Input</span>\n                <button class="example-run-btn" title="Run">\n                  <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">\n                    <polygon points="5 3 19 12 5 21 5 3"></polygon>\n                  </svg>\n                  Run\n                </button>\n              </div>\n              <div class="example-editor-container example-input-editor" id="${this.container.id}-input-editor"></div>\n            </div>\n            <div class="example-io-row example-output-row">\n              <div class="example-panel-header">\n                <span class="example-panel-title">Tokens</span>\n                <span class="example-token-count" id="${this.container.id}-token-count"></span>\n              </div>\n              <div class="example-output-container" id="${this.container.id}-output"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `}renderIncrementalMode(e){this.container.innerHTML=`\n      <div class="example-runner example-runner-incremental">\n        <div class="example-main">\n          ${e?`\n          <div class="example-column example-rules-column">\n            <div class="example-panel-header">\n              <span class="example-panel-title">Lexer Rules</span>\n              <button class="example-copy-btn" data-target="rules" title="Copy rules">\n                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>\n                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>\n                </svg>\n              </button>\n            </div>\n            <div class="example-editor-container" id="${this.container.id}-rules-editor"></div>\n          </div>\n          `:""}\n          <div class="example-column example-io-column">\n            <div class="example-io-row example-input-row">\n              <div class="example-panel-header">\n                <span class="example-panel-title">Input</span>\n                <span class="example-hint">(Edit to see incremental updates)</span>\n                <button class="example-run-btn" title="Run">\n                  <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">\n                    <polygon points="5 3 19 12 5 21 5 3"></polygon>\n                  </svg>\n                  Run\n                </button>\n              </div>\n              <div class="example-editor-container example-input-editor" id="${this.container.id}-input-editor"></div>\n            </div>\n            <div class="example-io-row example-output-row example-comparison-row">\n              <div class="example-comparison-columns">\n                <div class="example-comparison-column">\n                  <div class="example-panel-header">\n                    <span class="example-panel-title">Full Tokenizer</span>\n                    <span class="example-token-count" id="${this.container.id}-full-stats"></span>\n                  </div>\n                  <div class="example-output-container" id="${this.container.id}-full-output"></div>\n                </div>\n                <div class="example-comparison-column">\n                  <div class="example-panel-header">\n                    <span class="example-panel-title">Incremental</span>\n                    <span class="example-token-count" id="${this.container.id}-incremental-stats"></span>\n                  </div>\n                  <div class="example-output-container" id="${this.container.id}-incremental-output"></div>\n                </div>\n              </div>\n              <div class="example-speedup-bar" id="${this.container.id}-speedup"></div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `}setupEditors(){const e=this.getEditorTheme();if(!1!==this.config.showRules){const t=document.getElementById(`${this.container.id}-rules-editor`);t&&(this.rulesEditor=r().edit(t),this.rulesEditor.setTheme(e),this.rulesEditor.session.setMode("ace/mode/text"),this.rulesEditor.setValue((this.config.rules||"").trim(),-1),this.rulesEditor.setOptions({fontSize:"13px",showPrintMargin:!1,maxLines:20,minLines:5}))}const t=document.getElementById(`${this.container.id}-input-editor`);t&&(this.inputEditor=r().edit(t),this.inputEditor.setTheme(e),this.inputEditor.session.setMode("ace/mode/text"),this.inputEditor.setValue((this.config.input||"").trim(),-1),this.inputEditor.setOptions({fontSize:"13px",showPrintMargin:!1,maxLines:10,minLines:3})),"incremental"===this.config.mode?(this.fullOutputContainer=document.getElementById(`${this.container.id}-full-output`),this.incrementalOutputContainer=document.getElementById(`${this.container.id}-incremental-output`),this.fullStatsEl=document.getElementById(`${this.container.id}-full-stats`),this.incrementalStatsEl=document.getElementById(`${this.container.id}-incremental-stats`)):this.outputContainer=document.getElementById(`${this.container.id}-output`)}setupEventListeners(){const e=this.container.querySelector(".example-run-btn");if(e&&e.addEventListener("click",()=>this.run()),this.container.querySelectorAll(".example-copy-btn").forEach(e=>{e.addEventListener("click",e=>{const t=e.currentTarget.dataset.target;this.copyToClipboard(t||"")})}),this.inputEditor?.commands.addCommand({name:"run",bindKey:{win:"Ctrl-Enter",mac:"Cmd-Enter"},exec:()=>this.run()}),this.rulesEditor?.commands.addCommand({name:"run",bindKey:{win:"Ctrl-Enter",mac:"Cmd-Enter"},exec:()=>this.run()}),"incremental"===this.config.mode&&this.inputEditor){let e=null;this.inputEditor.session.on("change",()=>{e&&clearTimeout(e),e=setTimeout(()=>this.run(),50)})}}updateEditorThemes(){const e=this.getEditorTheme();this.rulesEditor?.setTheme(e),this.inputEditor?.setTheme(e)}copyToClipboard(e){let t="";"rules"===e&&this.rulesEditor&&(t=this.rulesEditor.getValue()),t&&navigator.clipboard.writeText(t).then(()=>{this.showCopyFeedback(e)})}showCopyFeedback(e){const t=this.container.querySelector(`[data-target="${e}"]`);if(t){const e=t.innerHTML;t.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n        <polyline points="20 6 9 17 4 12"></polyline>\n      </svg>',setTimeout(()=>{t.innerHTML=e},1500)}}run(){"incremental"===this.config.mode?this.runIncremental():this.runBasic()}runBasic(){if(!this.outputContainer)return;const e=this.rulesEditor?.getValue()||this.config.rules||"",t=this.inputEditor?.getValue()||"";this.outputContainer.innerHTML='<div class="example-loading">Tokenizing...</div>';try{const n=l(e,{}),i=performance.now(),s=n.tokenize(t),a=performance.now()-i,r=document.getElementById(`${this.container.id}-token-count`);r&&(r.textContent=`${s.length} tokens (${a.toFixed(2)}ms)`),this.displayTokens(s)}catch(e){this.outputContainer.innerHTML=`<div class="example-error">${this.escapeHtml(e.message)}</div>`}}runIncremental(){const e=this.rulesEditor?.getValue()||this.config.rules||"",t=this.inputEditor?.getValue()||"";try{if(!this.tokenizer){this.tokenizer=l(e,{});const t=l(e,{});this.incrementalTokenizer=new s.IncrementalTokenizer(t),this.lastInput=""}const n=performance.now();this.tokenizer.reset();const i=this.tokenizer.tokenize(t),a=performance.now()-n,r=performance.now();let o=[];if(""===this.lastInput)o=this.incrementalTokenizer.tokenize(t);else{const e=this.computeEdit(this.lastInput,t);o=e?this.incrementalTokenizer.update(t,e):this.incrementalTokenizer.getTokens()}const d=performance.now()-r;this.lastInput=t,this.displayComparison(i,a,o,d)}catch(e){this.fullOutputContainer&&(this.fullOutputContainer.innerHTML=`<div class="example-error">${this.escapeHtml(e.message)}</div>`)}}computeEdit(e,t){if(e===t)return null;let n=0;const i=Math.min(e.length,t.length);for(;n<i&&e[n]===t[n];)n++;let s=0;for(;s<i-n&&e[e.length-1-s]===t[t.length-1-s];)s++;return{start:n,end:e.length-s,newText:t.slice(n,t.length-s)}}displayComparison(e,t,n,i){this.fullOutputContainer&&(this.fullOutputContainer.innerHTML=this.renderTokenRows(e)),this.fullStatsEl&&(this.fullStatsEl.textContent=`${e.length} in ${t.toFixed(2)}ms`),this.incrementalOutputContainer&&(this.incrementalOutputContainer.innerHTML=this.renderTokenRows(n)),this.incrementalStatsEl&&(this.incrementalStatsEl.textContent=`${n.length} in ${i.toFixed(2)}ms`);const s=document.getElementById(`${this.container.id}-speedup`);if(s&&t>0){const a=t/Math.max(i,.01),r=this.tokensEqual(e,n);s.innerHTML=`\n        <span class="speedup-label ${r?"match":"mismatch"}">\n          ${r?"✓":"✗"} Speedup: ${a.toFixed(1)}x faster\n        </span>\n      `}}renderTokenRows(e){return e.map((e,t)=>`\n        <div class="token-row">\n          <span class="token-index">${t}</span>\n          <span class="token-range">${e.start}-${e.end}</span>\n          <span class="token-tag">${this.escapeHtml(String(e.tag))}</span>\n          <span class="token-value">${this.escapeHtml(JSON.stringify(e.value))}</span>\n        </div>\n      `).join("")}tokensEqual(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n].tag!==t[n].tag||e[n].start!==t[n].start||e[n].end!==t[n].end)return!1;return!0}displayTokens(e){if(!this.outputContainer)return;if(0===e.length)return void(this.outputContainer.innerHTML='<div class="example-empty">No tokens</div>');let t='<div class="example-tokens">';e.forEach((e,n)=>{t+=`\n        <div class="token-row">\n          <span class="token-index">${n}</span>\n          <span class="token-range">${e.start}-${e.end}</span>\n          <span class="token-tag">${this.escapeHtml(String(e.tag))}</span>\n          <span class="token-value">${this.escapeHtml(JSON.stringify(e.value))}</span>\n        </div>\n      `}),t+="</div>",this.outputContainer.innerHTML=t}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}}document.addEventListener("DOMContentLoaded",()=>{(0,o.FG)(),document.querySelectorAll("[data-example-runner]").forEach(e=>{const t=e.id;if(!t)return;const n=e.getAttribute("data-example-config");if(n){try{const e=JSON.parse(n);new d(t,e)}catch(e){console.error("Failed to parse example config:",e)}return}const i=document.getElementById(`${t}-rules`),s=document.getElementById(`${t}-input`),a={rules:i?.textContent?.trim()||"",input:s?.textContent?.trim()||"",mode:e.getAttribute("data-example-mode")||"basic",showRules:"false"!==e.getAttribute("data-example-show-rules")};new d(t,a)})}),window.ExampleRunner=d}},n={};function i(e){var s=n[e];if(void 0!==s)return s.exports;var a=n[e]={id:e,loaded:!1,exports:{}};return t[e](a,a.exports,i),a.loaded=!0,a.exports}i.m=t,i.amdD=function(){throw new Error("define cannot be used indirect")},e=[],i.O=(t,n,s,a)=>{if(!n){var r=1/0;for(u=0;u<e.length;u++){for(var[n,s,a]=e[u],o=!0,l=0;l<n.length;l++)(!1&a||r>=a)&&Object.keys(i.O).every(e=>i.O[e](n[l]))?n.splice(l--,1):(o=!1,a<r&&(r=a));if(o){e.splice(u--,1);var d=s();void 0!==d&&(t=d)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[n,s,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={549:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var s,a,[r,o,l]=n,d=0;if(r.some(t=>0!==e[t])){for(s in o)i.o(o,s)&&(i.m[s]=o[s]);if(l)var u=l(i)}for(t&&t(n);d<r.length;d++)a=r[d],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(u)},n=this.webpackChunktlex=this.webpackChunktlex||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var s=i.O(void 0,[59,789,164],()=>i(2841));return i.O(s)})());
//# sourceMappingURL=ExampleRunner.a397eab9ee8ce594d5eb.js.map