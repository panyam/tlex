<!DOCTYPE html>









<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Tokenizer for C-style languages with comments and states">
    <title>C Lexer - TLEX</title>

    
    <script>
        (function() {
            var theme = localStorage.getItem('theme');
            if (theme === 'dark' || (!theme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>

    
    <link rel="stylesheet" href="/tlex/static/css/tsappkit-docs.css">
    <link rel="stylesheet" href="/tlex/static/css/main.css">
    

    
    <link rel="icon" type="image/png" href="/tlex/static/images/favicon.png">
</head>
<body class="">
    
    
<header class="site-header">
    <div class="header-container">
        
        <div class="logo">
            <a href="/tlex/">
                <span class="logo-text">TLEX</span>
            </a>
        </div>

        <nav class="main-nav">
            
            
            <div class="nav-item">
                <a href="/tlex/getting-started/" class="nav-link">
                    
                    Getting Started
                </a>
                
            </div>
            
            <div class="nav-item">
                <a href="/tlex/playground/" class="nav-link">
                    
                    Playground
                </a>
                
            </div>
            
            <div class="nav-item has-children">
                <a href="/tlex/concepts/" class="nav-link">
                    
                    Concepts
                </a>
                
                <div class="nav-dropdown">
                    
                    <a href="/tlex/concepts/regex-ast/" class="dropdown-item">Regex AST</a>
                    
                    <a href="/tlex/concepts/vm-architecture/" class="dropdown-item">VM Architecture</a>
                    
                </div>
                
            </div>
            
            <div class="nav-item has-children">
                <a href="/tlex/reference/" class="nav-link">
                    
                    Reference
                </a>
                
                <div class="nav-dropdown">
                    
                    <a href="/tlex/reference/api/" class="dropdown-item">API Reference</a>
                    
                    <a href="/tlex/reference/incremental-tokenizer/" class="dropdown-item">Incremental Tokenizer</a>
                    
                    <a href="/tlex/reference/js-regex-syntax/" class="dropdown-item">JavaScript Regex</a>
                    
                    <a href="/tlex/reference/flex-syntax/" class="dropdown-item">Flex Syntax</a>
                    
                    <a href="/tlex/reference/rule-config/" class="dropdown-item">Rule Config</a>
                    
                    <a href="/tlex/reference/tokenizer-states/" class="dropdown-item">Tokenizer States</a>
                    
                </div>
                
            </div>
            
            <div class="nav-item has-children">
                <a href="/tlex/guides/" class="nav-link">
                    
                    Guides
                </a>
                
                <div class="nav-dropdown">
                    
                    <a href="/tlex/guides/editor-integration/" class="dropdown-item">Editor Integration</a>
                    
                </div>
                
            </div>
            
            <div class="nav-item has-children">
                <a href="/tlex/examples/" class="nav-link">
                    
                    Examples
                </a>
                
                <div class="nav-dropdown">
                    
                    <a href="/tlex/examples/json-tokenizer/" class="dropdown-item">JSON Tokenizer</a>
                    
                    <a href="/tlex/examples/calculator/" class="dropdown-item">Calculator</a>
                    
                    <a href="/tlex/examples/c-lexer/" class="dropdown-item">C Lexer</a>
                    
                </div>
                
            </div>
            
        </nav>

        <div class="header-actions">
            <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode" title="Toggle dark mode">
                
                <svg class="icon-sun" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                
                <svg class="icon-moon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
            </button>
            <a href="https://github.com/panyam/tlex" class="btn-github" target="_blank" rel="noopener">
                GitHub
            </a>
        </div>
    </div>
</header>


    
    <div class="page-container">
        
        
<aside class="sidebar">
    <div class="sidebar-content">
        

        
        <nav class="section-nav">
            
            <div class="section-nav-content">
                <h3>Examples</h3>
                <ul>
                    <li><a href="/tlex/examples/">Overview</a></li>
                    <li><a href="/tlex/examples/json-tokenizer/">JSON Tokenizer</a></li>
                    <li><a href="/tlex/examples/calculator/">Calculator</a></li>
                    <li><a href="/tlex/examples/c-lexer/">C Lexer</a></li>
                </ul>
            </div>
            
        </nav>
    </div>
</aside>


        
        <main class="main-content">
            
<article class="content">
    
    
    <header class="content-header">
        <h1>C Lexer</h1>
        
        <p class="lead">Tokenizer for C-style languages with comments and states</p>
        
    </header>
    

    
    <div class="content-body">
        
            
            
            <h2 id="overview">Overview <a class="anchor" href="#overview">¶</a></h2>
<p>This example demonstrates building a tokenizer for C-style programming languages. It showcases:</p>
<ul>
<li>Keyword vs identifier priority</li>
<li>Multi-character operators</li>
<li>String and character literals with escapes</li>
<li>Single-line and multi-line comments</li>
<li>State-based tokenization for block comments</li>
<li>Preprocessor directives</li>
</ul>
<h2 id="c-token-types">C Token Types <a class="anchor" href="#c-token-types">¶</a></h2>
<table>
<thead>
<tr>
<th>Token</th>
<th>Pattern</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td>KEYWORD</td>
<td>Reserved words</td>
<td><code>if</code>, <code>while</code>, <code>return</code>, <code>int</code></td>
</tr>
<tr>
<td>IDENTIFIER</td>
<td>Names</td>
<td><code>foo</code>, <code>myVar</code>, <code>_count</code></td>
</tr>
<tr>
<td>NUMBER</td>
<td>Integers and floats</td>
<td><code>42</code>, <code>3.14</code>, <code>0xFF</code></td>
</tr>
<tr>
<td>STRING</td>
<td>Double-quoted</td>
<td><code>&quot;hello&quot;</code>, <code>&quot;line\n&quot;</code></td>
</tr>
<tr>
<td>CHAR</td>
<td>Single-quoted</td>
<td><code>'a'</code>, <code>'\n'</code></td>
</tr>
<tr>
<td>OPERATOR</td>
<td>Arithmetic, logic</td>
<td><code>+</code>, <code>==</code>, <code>&amp;&amp;</code>, <code>&lt;&lt;</code></td>
</tr>
<tr>
<td>PUNCTUATION</td>
<td>Delimiters</td>
<td><code>{</code>, <code>}</code>, <code>;</code>, <code>,</code></td>
</tr>
<tr>
<td>COMMENT</td>
<td>Single/multi-line</td>
<td><code>// ...</code>, <code>/* ... */</code></td>
</tr>
<tr>
<td>PREPROCESSOR</td>
<td>Directives</td>
<td><code>#include</code>, <code>#define</code></td>
</tr>
</tbody>
</table>
<h2 id="basic-implementation">Basic Implementation <a class="anchor" href="#basic-implementation">¶</a></h2>
<pre><code><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Tokenizer</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;tlex&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cLexer</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Tokenizer</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Keywords (higher priority than identifiers)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">keywords</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;auto&#39;</span>, <span style="color:#e6db74">&#39;break&#39;</span>, <span style="color:#e6db74">&#39;case&#39;</span>, <span style="color:#e6db74">&#39;char&#39;</span>, <span style="color:#e6db74">&#39;const&#39;</span>, <span style="color:#e6db74">&#39;continue&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;default&#39;</span>, <span style="color:#e6db74">&#39;do&#39;</span>, <span style="color:#e6db74">&#39;double&#39;</span>, <span style="color:#e6db74">&#39;else&#39;</span>, <span style="color:#e6db74">&#39;enum&#39;</span>, <span style="color:#e6db74">&#39;extern&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;float&#39;</span>, <span style="color:#e6db74">&#39;for&#39;</span>, <span style="color:#e6db74">&#39;goto&#39;</span>, <span style="color:#e6db74">&#39;if&#39;</span>, <span style="color:#e6db74">&#39;int&#39;</span>, <span style="color:#e6db74">&#39;long&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;register&#39;</span>, <span style="color:#e6db74">&#39;return&#39;</span>, <span style="color:#e6db74">&#39;short&#39;</span>, <span style="color:#e6db74">&#39;signed&#39;</span>, <span style="color:#e6db74">&#39;sizeof&#39;</span>, <span style="color:#e6db74">&#39;static&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;struct&#39;</span>, <span style="color:#e6db74">&#39;switch&#39;</span>, <span style="color:#e6db74">&#39;typedef&#39;</span>, <span style="color:#e6db74">&#39;union&#39;</span>, <span style="color:#e6db74">&#39;unsigned&#39;</span>, <span style="color:#e6db74">&#39;void&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#39;volatile&#39;</span>, <span style="color:#e6db74">&#39;while&#39;</span>
</span></span><span style="display:flex;"><span>];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Add keywords with word boundaries
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">keywords</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">kw</span> <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> RegExp(<span style="color:#e6db74">`\\b</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">kw</span><span style="color:#e6db74">}</span><span style="color:#e6db74">\\b`</span>), { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;KEYWORD&#34;</span>, <span style="color:#a6e22e">priority</span>: <span style="color:#66d9ef">20</span> });
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Identifiers (lower priority - matched when not a keyword)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[a-zA-Z_][a-zA-Z0-9_]*/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;IDENTIFIER&#34;</span>, <span style="color:#a6e22e">priority</span>: <span style="color:#66d9ef">10</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Numbers
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/0[xX][0-9a-fA-F]+[uUlL]*/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;HEX&#34;</span> });        <span style="color:#75715e">// Hex
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/0[0-7]+[uUlL]*/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;OCTAL&#34;</span> });                 <span style="color:#75715e">// Octal
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[0-9]+\.[0-9]*([eE][+-]?[0-9]+)?[fFlL]?/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;FLOAT&#34;</span> }); <span style="color:#75715e">// Float
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[0-9]+[eE][+-]?[0-9]+[fFlL]?/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;FLOAT&#34;</span> });   <span style="color:#75715e">// Float with exp
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[0-9]+[uUlL]*/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;INTEGER&#34;</span> });                <span style="color:#75715e">// Integer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// String and character literals
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/&#34;(?:[^&#34;\\]|\\.)*&#34;/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;STRING&#34;</span> });
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/&#39;(?:[^&#39;\\]|\\.)+&#39;/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;CHAR&#34;</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Multi-character operators (check first due to maximal munch)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/-&gt;|&lt;&lt;|&gt;&gt;|&lt;=|&gt;=|==|!=|&amp;&amp;|\|\||\+\+|--|[+\-*\/%&amp;|^]=?/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;OPERATOR&#34;</span> });
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[+\-*\/%&lt;&gt;=!&amp;|^~?:]/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;OPERATOR&#34;</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Punctuation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[{}()\[\];,.]/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PUNCTUATION&#34;</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Comments (skip)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\/\/[^\n]*/</span>, { <span style="color:#a6e22e">skip</span>: <span style="color:#66d9ef">true</span> });           <span style="color:#75715e">// Single-line
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\/\*[\s\S]*?\*\//</span>, { <span style="color:#a6e22e">skip</span>: <span style="color:#66d9ef">true</span> });     <span style="color:#75715e">// Multi-line
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Preprocessor directives
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/#\s*[a-z]+[^\n]*/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PREPROCESSOR&#34;</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Whitespace (skip)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\s+/</span>, { <span style="color:#a6e22e">skip</span>: <span style="color:#66d9ef">true</span> });
</span></span></code></pre></code></pre><h2 id="try-it-live">Try It Live <a class="anchor" href="#try-it-live">¶</a></h2>
<div id="example-c-basic" data-example-runner></div>
<pre id="example-c-basic-rules" style="display:none">%token KEYWORD /\b(if|else|while|for|return|int|void|char|float|double|struct|typedef|const|static|extern|sizeof)\b/ 20
%token IDENTIFIER /[a-zA-Z_][a-zA-Z0-9_]*/ 10
%token HEX /0[xX][0-9a-fA-F]+/
%token FLOAT /[0-9]+\.[0-9]*([eE][+-]?[0-9]+)?/
%token INTEGER /[0-9]+/
%token STRING /"(?:[^"\\]|\\.)*"/
%token CHAR /'(?:[^'\\]|\\.)+'/
%token OPERATOR /->|<<|>>|<=|>=|==|!=|&&|\|\||\+\+|--|[+\-*\/%&|^]=?|[+\-*\/%<>=!&|^~?:]/
%token PUNCTUATION /[{}()\[\];,.]/
%token PREPROCESSOR /#\s*[a-z]+[^\n]*/
%skip /\/\/[^\n]*/
%skip /\/\*[\s\S]*?\*\//
%skip /\s+/</pre>
<pre id="example-c-basic-input" style="display:none">int main(void) {
    int x = 42;
    float pi = 3.14;
    // This is a comment
    if (x >= 10 && x <= 100) {
        printf("x = %d\n", x);
    }
    return 0;
}</pre>
<hr />
<h2 id="state-based-block-comments">State-Based Block Comments <a class="anchor" href="#state-based-block-comments">¶</a></h2>
<p>For more robust multi-line comment handling, use lexer states. This approach:</p>
<ul>
<li>Handles unterminated comments gracefully</li>
<li>Allows incremental parsing mid-comment</li>
<li>Provides better error messages</li>
</ul>
<pre><code><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Tokenizer</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;tlex&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cLexer</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Tokenizer</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Normal code tokens (only active in INITIAL state)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[a-zA-Z_][a-zA-Z0-9_]*/</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;IDENTIFIER&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">activeStates</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;INITIAL&#34;</span>]
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[0-9]+/</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;NUMBER&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">activeStates</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;INITIAL&#34;</span>]
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Enter block comment state
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\/\*/</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;COMMENT_START&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">activeStates</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;INITIAL&#34;</span>]
</span></span><span style="display:flex;"><span>}, (<span style="color:#a6e22e">rule</span>, <span style="color:#a6e22e">tape</span>, <span style="color:#a6e22e">token</span>, <span style="color:#a6e22e">tokenizer</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tokenizer</span>.<span style="color:#a6e22e">pushState</span>(<span style="color:#e6db74">&#34;COMMENT&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">token</span>;
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Inside block comment - match content
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[^*]+/</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;COMMENT_CONTENT&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">activeStates</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;COMMENT&#34;</span>]
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Inside block comment - match lone stars
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\*(?!\/)/</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;COMMENT_CONTENT&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">activeStates</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;COMMENT&#34;</span>]
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Exit block comment state
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\*\//</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;COMMENT_END&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">activeStates</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;COMMENT&#34;</span>]
</span></span><span style="display:flex;"><span>}, (<span style="color:#a6e22e">rule</span>, <span style="color:#a6e22e">tape</span>, <span style="color:#a6e22e">token</span>, <span style="color:#a6e22e">tokenizer</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">tokenizer</span>.<span style="color:#a6e22e">popState</span>();
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">token</span>;
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Single-line comment (no state change needed)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\/\/[^\n]*/</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">skip</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">activeStates</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;INITIAL&#34;</span>]
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Whitespace
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">cLexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\s+/</span>, { <span style="color:#a6e22e">skip</span>: <span style="color:#66d9ef">true</span> });
</span></span></code></pre></code></pre><h3 id="how-states-work">How States Work <a class="anchor" href="#how-states-work">¶</a></h3>
<pre><code><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span>Input: &#34;x /* comment */ y&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Position 0: State = INITIAL
</span></span><span style="display:flex;"><span>  Match &#34;x&#34; → IDENTIFIER
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Position 2: State = INITIAL
</span></span><span style="display:flex;"><span>  Match &#34;/*&#34; → COMMENT_START, pushState(&#34;COMMENT&#34;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Position 4: State = COMMENT
</span></span><span style="display:flex;"><span>  Match &#34; comment &#34; → COMMENT_CONTENT
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Position 13: State = COMMENT
</span></span><span style="display:flex;"><span>  Match &#34;*/&#34; → COMMENT_END, popState()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Position 16: State = INITIAL
</span></span><span style="display:flex;"><span>  Match &#34;y&#34; → IDENTIFIER
</span></span></code></pre></code></pre><hr />
<h2 id="enhanced-implementation">Enhanced Implementation <a class="anchor" href="#enhanced-implementation">¶</a></h2>
<p>Full implementation with value processing:</p>
<pre><code><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Tokenizer</span>, <span style="color:#a6e22e">Token</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;tlex&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">createCLexer</span>()<span style="color:#f92672">:</span> <span style="color:#a6e22e">Tokenizer</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">lexer</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Tokenizer</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Keywords
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">keywords</span> <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;auto&#39;</span>, <span style="color:#e6db74">&#39;break&#39;</span>, <span style="color:#e6db74">&#39;case&#39;</span>, <span style="color:#e6db74">&#39;char&#39;</span>, <span style="color:#e6db74">&#39;const&#39;</span>, <span style="color:#e6db74">&#39;continue&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;default&#39;</span>, <span style="color:#e6db74">&#39;do&#39;</span>, <span style="color:#e6db74">&#39;double&#39;</span>, <span style="color:#e6db74">&#39;else&#39;</span>, <span style="color:#e6db74">&#39;enum&#39;</span>, <span style="color:#e6db74">&#39;extern&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;float&#39;</span>, <span style="color:#e6db74">&#39;for&#39;</span>, <span style="color:#e6db74">&#39;goto&#39;</span>, <span style="color:#e6db74">&#39;if&#39;</span>, <span style="color:#e6db74">&#39;int&#39;</span>, <span style="color:#e6db74">&#39;long&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;register&#39;</span>, <span style="color:#e6db74">&#39;return&#39;</span>, <span style="color:#e6db74">&#39;short&#39;</span>, <span style="color:#e6db74">&#39;signed&#39;</span>, <span style="color:#e6db74">&#39;sizeof&#39;</span>, <span style="color:#e6db74">&#39;static&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;struct&#39;</span>, <span style="color:#e6db74">&#39;switch&#39;</span>, <span style="color:#e6db74">&#39;typedef&#39;</span>, <span style="color:#e6db74">&#39;union&#39;</span>, <span style="color:#e6db74">&#39;unsigned&#39;</span>, <span style="color:#e6db74">&#39;void&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#39;volatile&#39;</span>, <span style="color:#e6db74">&#39;while&#39;</span>
</span></span><span style="display:flex;"><span>  ];
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">keywords</span>.<span style="color:#a6e22e">forEach</span>(<span style="color:#a6e22e">kw</span> <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> RegExp(<span style="color:#e6db74">`\\b</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">kw</span><span style="color:#e6db74">}</span><span style="color:#e6db74">\\b`</span>), { <span style="color:#a6e22e">tag</span>: <span style="color:#66d9ef">kw.toUpperCase</span>(), <span style="color:#a6e22e">priority</span>: <span style="color:#66d9ef">20</span> });
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Identifiers
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[a-zA-Z_][a-zA-Z0-9_]*/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;IDENTIFIER&#34;</span>, <span style="color:#a6e22e">priority</span>: <span style="color:#66d9ef">10</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Numbers with value conversion
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/0[xX][0-9a-fA-F]+/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;NUMBER&#34;</span> }, (<span style="color:#a6e22e">rule</span>, <span style="color:#a6e22e">tape</span>, <span style="color:#a6e22e">token</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">numValue</span> <span style="color:#f92672">=</span> parseInt(<span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">value</span>, <span style="color:#ae81ff">16</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">token</span>;
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/0[0-7]+/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;NUMBER&#34;</span> }, (<span style="color:#a6e22e">rule</span>, <span style="color:#a6e22e">tape</span>, <span style="color:#a6e22e">token</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">numValue</span> <span style="color:#f92672">=</span> parseInt(<span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">value</span>, <span style="color:#ae81ff">8</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">token</span>;
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[0-9]+\.[0-9]*(?:[eE][+-]?[0-9]+)?/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;NUMBER&#34;</span> }, (<span style="color:#a6e22e">rule</span>, <span style="color:#a6e22e">tape</span>, <span style="color:#a6e22e">token</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">numValue</span> <span style="color:#f92672">=</span> parseFloat(<span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">value</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">token</span>;
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[0-9]+/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;NUMBER&#34;</span> }, (<span style="color:#a6e22e">rule</span>, <span style="color:#a6e22e">tape</span>, <span style="color:#a6e22e">token</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">numValue</span> <span style="color:#f92672">=</span> parseInt(<span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">value</span>, <span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">token</span>;
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Strings with escape processing
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/&#34;(?:[^&#34;\\]|\\.)*&#34;/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;STRING&#34;</span> }, (<span style="color:#a6e22e">rule</span>, <span style="color:#a6e22e">tape</span>, <span style="color:#a6e22e">token</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">stringValue</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">processEscapes</span>(<span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">value</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">token</span>;
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Characters
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/&#39;(?:[^&#39;\\]|\\.)+&#39;/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;CHAR&#34;</span> }, (<span style="color:#a6e22e">rule</span>, <span style="color:#a6e22e">tape</span>, <span style="color:#a6e22e">token</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">charValue</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">processEscapes</span>(<span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">value</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">token</span>;
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Operators
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/-&gt;/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ARROW&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\+\+/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;INCREMENT&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/--/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;DECREMENT&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/&lt;&lt;/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;LEFT_SHIFT&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/&gt;&gt;/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;RIGHT_SHIFT&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/&lt;=/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;LESS_EQUAL&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/&gt;=/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;GREATER_EQUAL&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/==/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;EQUAL&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/!=/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;NOT_EQUAL&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/&amp;&amp;/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;LOGICAL_AND&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\|\|/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;LOGICAL_OR&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[+\-*\/%]/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ARITHMETIC_OP&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[&lt;&gt;=!]/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;RELATIONAL_OP&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/[&amp;|^~]/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;BITWISE_OP&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\?/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;QUESTION&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/:/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;COLON&#34;</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Punctuation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\{/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;LBRACE&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\}/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;RBRACE&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\(/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;LPAREN&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\)/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;RPAREN&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\[/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;LBRACKET&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\]/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;RBRACKET&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/;/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;SEMICOLON&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/,/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;COMMA&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\./</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;DOT&#34;</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Comments
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\/\/[^\n]*/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;LINE_COMMENT&#34;</span>, <span style="color:#a6e22e">skip</span>: <span style="color:#66d9ef">true</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\/\*[\s\S]*?\*\//</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;BLOCK_COMMENT&#34;</span>, <span style="color:#a6e22e">skip</span>: <span style="color:#66d9ef">true</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Preprocessor
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/#\s*include\s*[&lt;&#34;][^&gt;&#34;]+[&gt;&#34;]/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;INCLUDE&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/#\s*define\s+[a-zA-Z_][a-zA-Z0-9_]*[^\n]*/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;DEFINE&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/#\s*ifdef\s+[a-zA-Z_][a-zA-Z0-9_]*/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;IFDEF&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/#\s*ifndef\s+[a-zA-Z_][a-zA-Z0-9_]*/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;IFNDEF&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/#\s*endif/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ENDIF&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/#\s*else/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PP_ELSE&#34;</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/#\s*elif[^\n]*/</span>, { <span style="color:#a6e22e">tag</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ELIF&#34;</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Whitespace
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">/\s+/</span>, { <span style="color:#a6e22e">skip</span>: <span style="color:#66d9ef">true</span> });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">lexer</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">processEscapes</span>(<span style="color:#a6e22e">str</span>: <span style="color:#66d9ef">string</span>)<span style="color:#f92672">:</span> <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">str</span>
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/\\n/g</span>, <span style="color:#e6db74">&#39;\n&#39;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/\\r/g</span>, <span style="color:#e6db74">&#39;\r&#39;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/\\t/g</span>, <span style="color:#e6db74">&#39;\t&#39;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/\\0/g</span>, <span style="color:#e6db74">&#39;\0&#39;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/\\&#39;/g</span>, <span style="color:#e6db74">&#34;&#39;&#34;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/\\&#34;/g</span>, <span style="color:#e6db74">&#39;&#34;&#39;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/\\\\/g</span>, <span style="color:#e6db74">&#39;\\&#39;</span>)
</span></span><span style="display:flex;"><span>    .<span style="color:#a6e22e">replace</span>(<span style="color:#e6db74">/\\x([0-9a-fA-F]{2})/g</span>, (<span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">hex</span>) <span style="color:#f92672">=&gt;</span>
</span></span><span style="display:flex;"><span>      String.<span style="color:#a6e22e">fromCharCode</span>(parseInt(<span style="color:#a6e22e">hex</span>, <span style="color:#ae81ff">16</span>))
</span></span><span style="display:flex;"><span>    );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></code></pre><hr />
<h2 id="pattern-breakdown">Pattern Breakdown <a class="anchor" href="#pattern-breakdown">¶</a></h2>
<h3 id="identifier-pattern">Identifier Pattern <a class="anchor" href="#identifier-pattern">¶</a></h3>
<pre><code>[a-zA-Z_][a-zA-Z0-9_]*
</code></pre><table>
<thead>
<tr>
<th>Part</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[a-zA-Z_]</code></td>
<td>First char: letter or underscore</td>
</tr>
<tr>
<td><code>[a-zA-Z0-9_]*</code></td>
<td>Rest: letters, digits, underscores</td>
</tr>
</tbody>
</table>
<h3 id="float-pattern">Float Pattern <a class="anchor" href="#float-pattern">¶</a></h3>
<pre><code>[0-9]+\.[0-9]*([eE][+-]?[0-9]+)?
</code></pre><table>
<thead>
<tr>
<th>Part</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[0-9]+</code></td>
<td>Integer part (required)</td>
</tr>
<tr>
<td><code>\.</code></td>
<td>Decimal point</td>
</tr>
<tr>
<td><code>[0-9]*</code></td>
<td>Fractional part (optional)</td>
</tr>
<tr>
<td><code>([eE][+-]?[0-9]+)?</code></td>
<td>Optional exponent</td>
</tr>
</tbody>
</table>
<h3 id="string-pattern">String Pattern <a class="anchor" href="#string-pattern">¶</a></h3>
<pre><code>&quot;(?:[^&quot;\\]|\\.)*&quot;
</code></pre><table>
<thead>
<tr>
<th>Part</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&quot;</code></td>
<td>Opening quote</td>
</tr>
<tr>
<td><code>[^&quot;\\]</code></td>
<td>Any char except <code>&quot;</code> or <code>\</code></td>
</tr>
<tr>
<td><code>\\.</code></td>
<td>Escape sequence (backslash + any char)</td>
</tr>
<tr>
<td><code>*</code></td>
<td>Zero or more of above</td>
</tr>
<tr>
<td><code>&quot;</code></td>
<td>Closing quote</td>
</tr>
</tbody>
</table>
<h3 id="block-comment-pattern">Block Comment Pattern <a class="anchor" href="#block-comment-pattern">¶</a></h3>
<pre><code>\/\*[\s\S]*?\*\/
</code></pre><table>
<thead>
<tr>
<th>Part</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\/\*</code></td>
<td>Opening <code>/*</code></td>
</tr>
<tr>
<td><code>[\s\S]*?</code></td>
<td>Any chars (non-greedy)</td>
</tr>
<tr>
<td><code>\*\/</code></td>
<td>Closing <code>*/</code></td>
</tr>
</tbody>
</table>
<p>Note: <code>[\s\S]</code> matches any character including newlines (unlike <code>.</code>).</p>
<hr />
<h2 id="usage-example">Usage Example <a class="anchor" href="#usage-example">¶</a></h2>
<pre><code><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">lexer</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createCLexer</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">code</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">#include &lt;stdio.h&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">/* Multi-line
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">   comment */
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int factorial(int n) {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    if (n &lt;= 1) return 1;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    return n * factorial(n - 1);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">int main(void) {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    int result = factorial(5);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    printf(&#34;5! = %d\\n&#34;, result);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    return 0;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tokens</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">tokenize</span>(<span style="color:#a6e22e">code</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">token</span> <span style="color:#66d9ef">of</span> <span style="color:#a6e22e">tokens</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">tag</span>.<span style="color:#a6e22e">padEnd</span>(<span style="color:#ae81ff">15</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">value</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></code></pre><p>Output:</p>
<pre><code><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span>INCLUDE         #include &lt;stdio.h&gt;
</span></span><span style="display:flex;"><span>INT             int
</span></span><span style="display:flex;"><span>IDENTIFIER      factorial
</span></span><span style="display:flex;"><span>LPAREN          (
</span></span><span style="display:flex;"><span>INT             int
</span></span><span style="display:flex;"><span>IDENTIFIER      n
</span></span><span style="display:flex;"><span>RPAREN          )
</span></span><span style="display:flex;"><span>LBRACE          {
</span></span><span style="display:flex;"><span>IF              if
</span></span><span style="display:flex;"><span>LPAREN          (
</span></span><span style="display:flex;"><span>IDENTIFIER      n
</span></span><span style="display:flex;"><span>LESS_EQUAL      &lt;=
</span></span><span style="display:flex;"><span>NUMBER          1
</span></span><span style="display:flex;"><span>RPAREN          )
</span></span><span style="display:flex;"><span>RETURN          return
</span></span><span style="display:flex;"><span>NUMBER          1
</span></span><span style="display:flex;"><span>SEMICOLON       ;
</span></span><span style="display:flex;"><span>RETURN          return
</span></span><span style="display:flex;"><span>IDENTIFIER      n
</span></span><span style="display:flex;"><span>ARITHMETIC_OP   *
</span></span><span style="display:flex;"><span>IDENTIFIER      factorial
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></code></pre><hr />
<h2 id="error-handling">Error Handling <a class="anchor" href="#error-handling">¶</a></h2>
<pre><code><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#a6e22e">lexer</span>.<span style="color:#a6e22e">onError</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">error</span>, <span style="color:#a6e22e">tape</span>, <span style="color:#a6e22e">startIndex</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">line</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">getLineNumber</span>(<span style="color:#a6e22e">tape</span>.<span style="color:#a6e22e">input</span>, <span style="color:#a6e22e">startIndex</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">col</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">getColumn</span>(<span style="color:#a6e22e">tape</span>.<span style="color:#a6e22e">input</span>, <span style="color:#a6e22e">startIndex</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">char</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">tape</span>.<span style="color:#a6e22e">charAt</span>(<span style="color:#a6e22e">startIndex</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">SyntaxError</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">`Unexpected character &#39;</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">char</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#39; at line </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">line</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, column </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">col</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getLineNumber</span>(<span style="color:#a6e22e">input</span>: <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">index</span>: <span style="color:#66d9ef">number</span>)<span style="color:#f92672">:</span> <span style="color:#66d9ef">number</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">slice</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">index</span>).<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#39;\n&#39;</span>).<span style="color:#a6e22e">length</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getColumn</span>(<span style="color:#a6e22e">input</span>: <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">index</span>: <span style="color:#66d9ef">number</span>)<span style="color:#f92672">:</span> <span style="color:#66d9ef">number</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">lastNewline</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">lastIndexOf</span>(<span style="color:#e6db74">&#39;\n&#39;</span>, <span style="color:#a6e22e">index</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">index</span> <span style="color:#f92672">-</span> <span style="color:#a6e22e">lastNewline</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></code></pre><hr />
<h2 id="incremental-lexing-demo">Incremental Lexing Demo <a class="anchor" href="#incremental-lexing-demo">¶</a></h2>
<p>Try editing the code below to see incremental lexing in action. The left column shows full re-tokenization, while the right shows incremental updates. Watch the speedup indicator!</p>
<div id="example-c-incremental" data-example-runner data-example-mode="incremental" data-example-show-rules="false"></div>
<pre id="example-c-incremental-rules" style="display:none">%token KEYWORD /\b(if|else|while|for|return|int|void|char|float|double|struct|typedef|const|static|extern|sizeof)\b/ 20
%token IDENTIFIER /[a-zA-Z_][a-zA-Z0-9_]*/ 10
%token HEX /0[xX][0-9a-fA-F]+/
%token FLOAT /[0-9]+\.[0-9]*([eE][+-]?[0-9]+)?/
%token INTEGER /[0-9]+/
%token STRING /"(?:[^"\\]|\\.)*"/
%token CHAR /'(?:[^'\\]|\\.)+'/
%token OPERATOR /->|<<|>>|<=|>=|==|!=|&&|\|\||\+\+|--|[+\-*\/%&|^]=?|[+\-*\/%<>=!&|^~?:]/
%token PUNCTUATION /[{}()\[\];,.]/
%skip /\/\/[^\n]*/
%skip /\/\*[\s\S]*?\*\//
%skip /\s+/</pre>
<pre id="example-c-incremental-input" style="display:none">int factorial(int n) {
    if (n <= 1) return 1;
    return n * factorial(n - 1);
}
<p>int main(void) {<br />
int result = factorial(5);<br />
printf(&ldquo;Result: %d\n&rdquo;, result);<br />
return 0;<br />
}</pre></p>
<p><strong>Try these edits:</strong></p>
<ul>
<li>Add a digit to a number (e.g., change <code>5</code> to <code>50</code>)</li>
<li>Add a new variable declaration</li>
<li>Type a comment <code>// test</code></li>
</ul>
<h3 id="how-it-works">How It Works <a class="anchor" href="#how-it-works">¶</a></h3>
<pre><code><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span>Tokens BEFORE edit: Reused (no re-lex)
</span></span><span style="display:flex;"><span>  ┌─────────────────────────┐
</span></span><span style="display:flex;"><span>  │ INT, IDENTIFIER, ...    │  ← kept as-is
</span></span><span style="display:flex;"><span>  └─────────────────────────┘
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Affected token: Re-lexed
</span></span><span style="display:flex;"><span>  ┌─────────────────┐
</span></span><span style="display:flex;"><span>  │ NUMBER &#34;5&#34;      │  → NUMBER &#34;50&#34;
</span></span><span style="display:flex;"><span>  └─────────────────┘
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Tokens AFTER edit: Positions adjusted
</span></span><span style="display:flex;"><span>  ┌─────────────────────────────┐
</span></span><span style="display:flex;"><span>  │ PUNCTUATION, RETURN, ...    │  ← shifted by +1
</span></span><span style="display:flex;"><span>  └─────────────────────────────┘
</span></span></code></pre></code></pre><p>Incremental lexing is typically <strong>20-50x faster</strong> for single-character edits.</p>
<h3 id="code-example">Code Example <a class="anchor" href="#code-example">¶</a></h3>
<pre><code><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;"><code><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">IncrementalTokenizer</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;tlex&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">incLexer</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">IncrementalTokenizer</span>(<span style="color:#a6e22e">createCLexer</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Initial tokenization
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">tokens</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">incLexer</span>.<span style="color:#a6e22e">tokenize</span>(<span style="color:#a6e22e">code</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// On edit, compute the change
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">edit</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">start</span>: <span style="color:#66d9ef">31</span>, <span style="color:#a6e22e">end</span>: <span style="color:#66d9ef">31</span>, <span style="color:#a6e22e">newText</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;0&#34;</span> };
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">newTokens</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">incLexer</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">newCode</span>, <span style="color:#a6e22e">edit</span>);
</span></span></code></pre></code></pre><p>See <a href="/tlex/reference/incremental-tokenizer/">Incremental Tokenizer API</a> for full documentation.</p>
<hr />
<h2 id="see-also">See Also <a class="anchor" href="#see-also">¶</a></h2>
<ul>
<li><a href="/tlex/reference/tokenizer-states/">Tokenizer States</a> - State management patterns</li>
<li><a href="/tlex/reference/rule-config/">Rule Configuration</a> - Priority and activeStates</li>
<li><a href="/tlex/reference/incremental-tokenizer/">Incremental Tokenizer</a> - Full API reference</li>
<li><a href="/tlex/guides/editor-integration/">Editor Integration</a> - Monaco, CodeMirror, Ace integration</li>
<li><a href="/tlex/examples/json-tokenizer/">JSON Tokenizer</a> - Simpler example</li>
</ul>

        
    </div>

    
    
</article>

        </main>
    </div>
    

    
    
    
<footer class="site-footer">
    <div class="footer-container">
        <div class="footer-section">
            <h4>TLEX</h4>
            <p>A powerful lexer generator and tokenizer library for TypeScript</p>
            <p class="version">Version 1.0.0</p>
        </div>

        <div class="footer-section">
            <h4>Quick Links</h4>
            <ul>
                <li><a href="/tlex/getting-started/">Getting Started</a></li>
                <li><a href="/tlex/concepts/">Concepts</a></li>
                <li><a href="/tlex/reference/">Reference</a></li>
                <li><a href="/tlex/examples/">Examples</a></li>
            </ul>
        </div>

        <div class="footer-section">
            <h4>Community</h4>
            <ul>
                <li><a href="https://github.com/panyam/tlex" target="_blank" rel="noopener">GitHub Repository</a></li>
                <li><a href="https://github.com/panyam/tlex/issues" target="_blank" rel="noopener">Report Issues</a></li>
                <li><a href="https://www.npmjs.com/package/tlex" target="_blank" rel="noopener">npm Package</a></li>
            </ul>
        </div>

        <div class="footer-section">
            <h4>License</h4>
            <p>Licensed under <a href="https://github.com/panyam/tlex/blob/master/LICENSE">MIT</a></p>
            <p>&copy;  Sriram Panyam</p>
        </div>
    </div>

    <div class="footer-bottom">
        <p>Built with <a href="https://github.com/panyam/s3gen" target="_blank">s3gen</a></p>
    </div>
</footer>

    

    
    
    <script defer="defer" src="/tlex/static/js/gen/59.53f8ed6f679c11016011.js"></script>
<script defer="defer" src="/tlex/static/js/gen/789.2fafa010c6ae4b792ae5.js"></script>
<script defer="defer" src="/tlex/static/js/gen/164.365da3f3f69a8f2fc6f3.js"></script>
<script defer="defer" src="/tlex/static/js/gen/ExampleRunner.a397eab9ee8ce594d5eb.js"></script>
    

    
    <script>
        (function() {
            var toggle = document.getElementById('theme-toggle');
            if (toggle) {
                toggle.addEventListener('click', function() {
                    var isDark = document.documentElement.classList.toggle('dark');
                    localStorage.setItem('theme', isDark ? 'dark' : 'light');
                });
            }
        })();
    </script>
</body>
</html>
